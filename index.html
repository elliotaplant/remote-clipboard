<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <style media="screen">
      * {
        box-sizing: border-box;
      }

      body, textarea, button {
        font-family: "Courier New", Courier, "Lucida Sans Typewriter", "Lucida Typewriter", monospace;
      }

      body {
        margin: 0 auto;
        text-align: center;
        width: 80%;
        max-width: 1024px;
        display: flex;
        align-items: center;
        flex-direction: column;
      }

      h1 {
        margin: 0.25em 0;
        font-size: 10vw;
        font-weight: bold;
      }

      textarea, button {
        width: 100%;
        display: block;
      }

      textarea {
        height: 40vh;
        font-size: 5vw;
        padding: 0.5em;
      }

      @media screen and (min-width: 1600px) {
        textarea {
           font-size: 30px;
        }
      }

      button {
        margin-top: 1em;
        font-family: monospace;
        font-size: 4em;
        border: 2px solid grey;
        border-radius: 4px;
        font-family: "Courier New", Courier, "Lucida Sans Typewriter", "Lucida Typewriter", monospace;
      }
    </style>
    <title>Remote clipboard</title>
  </head>
  <body>
    <h1>Remote Clipboard</h1>
    <textarea id="pasteTxt" placeholder="Paste text here then click 'Paste'"></textarea>
    <button type="button" id="pasteBtn">Paste</button>
    <button type="button" id="fetchBtn">Fetch</button>
    <div id="pasted"></div>

    <script type="text/javascript">
      function makePaste(body) {
        const url = 'https://remote-clipboard.netlify.app/.netlify/functions/paste';
        const options = { method: 'POST', body };
        return fetch(url, options).then(r => r.json());
      }

      function getPaste() {
        return fetch('https://remote-clipboard.netlify.app/.netlify/functions/copy')
          .then(resp => resp.text())
          .then((resp) => { pasteTxt.value = resp; })
          .catch(console.error);
      }

      function handleText(text) {
        makePaste(text)
          .then(() => displaySuccess())
          .catch(console.error)
      }

      function displaySuccess() {
        pasteBtn.style.borderColor = '#4bb543';
        pasteBtn.style.color = '#4bb543';
        pasteTxt.style.borderColor = '#4bb543';
        setTimeout(() => {
          pasteBtn.style.borderColor = 'grey';
          pasteBtn.style.color = 'grey';
          pasteTxt.style.borderColor = 'grey';
        }, 2000)
      }

      pasteBtn.onclick = () => handleText(pasteTxt.value);
      fetchBtn.onclick = () => getPaste();

      getPaste();
    </script>
  </body>
</html>
